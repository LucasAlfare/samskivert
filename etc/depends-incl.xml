<?xml version="1.0"?>

<!-- build configuration -->
<project name="samskivert-checks" basedir=".">

  <!-- checks to see which packages are available -->
  <target name="check-available">
    <echo level="info">The packages required for building are listed below. A package</echo>
    <echo level="info">followed by 'true' indicates that the package is present.</echo>
    <echo level="info"></echo>

    <available property="servlet2.3.present" classpathref="classpath"
     classname="javax.servlet.Servlet"/>
    <echo level="info">Servlet 2.3: ${servlet2.3.present}</echo>
    <available property="mail.present" classpathref="classpath"
     classname="javax.mail.Transport"/>
    <echo level="info">Java Mail: ${mail.present}</echo>
    <available property="jakarta.commons-colls.present" classpathref="classpath"
     classname="org.apache.commons.collections.CollectionUtils"/>
    <echo level="info">Commons Collections: ${jakarta.commons-colls.present}</echo>
    <available property="jakarta.commons-logging.present" classpathref="classpath"
     classname="org.apache.commons.logging.Log"/>
    <echo level="info">Commons Logging: ${jakarta.commons-logging.present}</echo>
    <available property="jakarta.commons-digester.present" classpathref="classpath"
     classname="org.apache.commons.digester.Digester"/>
    <echo level="info">Commons Digester: ${jakarta.commons-digester.present}</echo>
    <available property="jakarta.velocity.present" classpathref="classpath"
     classname="org.apache.velocity.Template"/>
    <echo level="info">Velocity: ${jakarta.velocity.present}</echo>
    <available property="log4j.present" classpathref="classpath"
     classname="org.apache.log4j.Logger"/>
    <echo level="info">log4j: ${log4j.present}</echo>
  </target>

  <!-- combines package availability into build controls -->
  <target name="compute-builds" depends="check-available">
    <echo level="info">The packages that will be built are listed below. One followed</echo>
    <echo level="info">by 'true' indicates that it will be built.</echo>
    <echo level="info"></echo>

    <condition property="build.servlet">
      <and>
        <isset property="servlet2.3.present"/>
      </and>
    </condition>
    <echo level="info">com.samskivert.servlet: ${build.servlet}</echo>

    <condition property="build.velocity">
      <and>
        <isset property="build.servlet"/>
        <isset property="jakarta.commons-colls.present"/>
        <isset property="jakarta.velocity.present"/>
        <isset property="servlet2.3.present"/>
      </and>
    </condition>
    <echo level="info">com.samskivert.velocity: ${build.velocity}</echo>

    <condition property="build.xml">
      <and>
        <isset property="jakarta.commons-logging.present"/>
        <isset property="jakarta.commons-digester.present"/>
      </and>
    </condition>
    <echo level="info">com.samskivert.xml: ${build.xml}</echo>

    <condition property="build.mail">
      <and>
        <isset property="mail.present"/>
      </and>
    </condition>
    <echo level="info">com.samskivert.net.MailUtil: ${build.mail}</echo>
  </target>

</project>
